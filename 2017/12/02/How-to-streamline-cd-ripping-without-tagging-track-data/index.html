<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>How to streamline cd ripping without tagging track data | Random Howtos</title>
  <meta name="author" content="Philipp Keller">
  
  <meta name="description" content="Since we recently stopped using Spotify (mainly because I think having everything at your fingertips influences brain in a negative way) we switched to borrowing CDs from the local library (which, in our case is only 200m away from our house).
Now, because the kids get CDs at least once a week, I needed a way to quickly import those CDs into our Sonos system without too much hassle. Since the kids only borrow children stories (spoken audio) which often are not on MusicBrainz, I needed an easy way to tag them myself. Because I don’t care about tagging every single track (because you usually listen to a story start to end anyway), I wanted to have a streamlined process. The following script does:

Rip the CD and convert it to m4a (AAC encoding, slightly better compression than mp3)
Eject the CD
Ask me for the album and artist name
Opens chrome so I can choose an artwork
Convert the artwork to JPG in a reasonable size
Copies the music to the directory on my NAS
Triggers Sonos to update the music library">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="generator" content="Hexo 2.6.0"/>

  <meta property="og:title" content="How to streamline cd ripping without tagging track data"/>
  <meta property="og:site_name" content="Random Howtos"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.png" rel="shortcut icon">

  
    <link rel="stylesheet" href="/css/highlightjs/atelier-estuary-light.css">
  
  <script src="/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <link rel="alternate" href="/atom.xml" title="Random Howtos" type="application/atom+xml">

  <link href="/css/site.css" rel="stylesheet">
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <script type="text/javascript" src="/js/jquery.caption.min.js"></script>
  <link href="/css/captionjs.min.css" rel="stylesheet"/>
  <script type="text/javascript" src="/js/ewal.js"></script>

  


</head>

<body>
  

<div class="navbar navbar-default navbar-static-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><span class="text-primary">Random Howtos</span></a>
    </div>
    <div class="collapse navbar-collapse navbar-right">
      <ul class="nav navbar-nav">
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives">Archives</a></li>
        
      </ul>
      <ul class="nav navbar-nav pull-right">
      
      
      
      
      </ul>
    </div>
  </div>
</div>


  <div class="container">
    <div class="row">
      <div><article class="post">
  
    <div class="post-date">
      <time datetime="2017-12-02T15:23:53.000Z">2017-12-02</time>
    </div>
    
  
    <h1 class="title">How to streamline cd ripping without tagging track data</h1>
  

  
  <div class="post-content">
    
      <p><img src="/images/automate.jpg" alt="CD tower to rip"></p>
<p>Since we recently stopped using Spotify (mainly because I think having everything at your fingertips influences brain in a negative way) we switched to borrowing CDs from the local library (which, in our case is only 200m away from our house).</p>
<p>Now, because the kids get CDs at least once a week, I needed a way to quickly import those CDs into our Sonos system without too much hassle. Since the kids only borrow children stories (spoken audio) which often are not on MusicBrainz, I needed an easy way to tag them myself. Because I don’t care about tagging every single track (because you usually listen to a story start to end anyway), I wanted to have a streamlined process. The following script does:</p>
<ul>
<li>Rip the CD and convert it to m4a (AAC encoding, slightly better compression than mp3)</li>
<li>Eject the CD</li>
<li>Ask me for the album and artist name</li>
<li>Opens chrome so I can choose an artwork</li>
<li>Convert the artwork to JPG in a reasonable size</li>
<li>Copies the music to the directory on my NAS</li>
<li>Triggers Sonos to update the music library</li>
</ul>
<a id="more"></a>
<p>You may take it as a starting point, you’d want to adapt:</p>
<ul>
<li>the paranoia level. <code>-Y</code> is only basic checking which is enough for me. You can remove the <code>-Y</code> to increase the error handle</li>
<li>the bitrate (line 7). 96k is enough for me</li>
<li>the genre (line 8)</li>
<li>the handling of special characters for the album directory name (line 15)</li>
<li>the hostname/directory of your NAS</li>
<li>the updating of the music library (line 23. For Sonos there’s <a href="https://github.com/SoCo/SoCo" target="_blank" rel="external">soco</a>, an awesome python library. If you want to use that you’d need to <code>pip install soco</code> first)</li>
</ul>
<p>Btw: the script can be run in parallel, i.e. when the first cd is finished ripping and the aac encoding runs you can insert the next disc and start the script again.</p>
<pre><code class="bash">#!/bin/bash

set -e
tmp_dir=$(mktemp -d)
cd $tmp_dir
cdparanoia -BY
eject
for i in *.wav; do ffmpeg -i $i -c:a libfdk_aac -b:a 96k ${i/cdda.wav/m4a}; done
total=$(ls *.m4a | wc -l); for i in *.m4a; do number=$(echo $i | sed &#39;s/^track\([0-9]\+\).*/\1/&#39;); AtomicParsley $i --tracknum &quot;$number/$total&quot; --title &quot;Track $number&quot; --genre &quot;Kinder Geschichten&quot; --overWrite; done
echo -n &quot;Album name&gt;&quot; &amp;&amp; read album
echo -n &quot;Artist name&gt;&quot; &amp;&amp; read artist
search_term=&quot;$(perl -MURI::Escape -e &#39;print uri_escape($ARGV[0]);&#39; &quot;$album $artist cd&quot;)&quot;
chrome &quot;https://www.google.ch/search?&amp;q=$search_term&amp;tbm=isch&quot; &gt;/dev/null 2&gt;/dev/null &amp;
echo -n &quot;Artwork url&gt;&quot; &amp;&amp; read artwork_url
wget -q &quot;$artwork_url&quot; -O artwork.orig
convert artwork.orig -resize &quot;250x&quot; artwork.jpg
for i in *.m4a; do AtomicParsley $i --artwork artwork.jpg --artist &quot;$artist&quot; --album &quot;$album&quot; --overWrite; done
dir_name=$(echo &quot;${artist// /_}_${album// /_}&quot; | sed &#39;s/Ö/oe/g; s/Ä/ae/g; s/Ü/ue/g; s/ä/ae/g; s/ö/oe/g; s/ü/ue/g&#39; | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39;)
mkdir $dir_name
mv *.m4a $dir_name
scp -rp $dir_name root@wdmycloud:/DataVolume/shares/Public/Shared\\\ Music/kinder
python3 -c &quot;import soco; soco.music_library.MusicLibrary().start_library_update()&quot;
cd -
rm -rf $tmp_dir
</code></pre>

    
  </div>
  
    

    
  
  <div class="tags">
    <a href="/tags/ripping/">ripping</a>, <a href="/tags/music/">music</a>
  </div>

  
  <div class="addthis_toolbox addthis_default_style 
addthis_32x32_style" data-addthis-url="http://howto.philippkeller.com/2017/12/02/How-to-streamline-cd-ripping-without-tagging-track-data/" data-addthis-title="How to streamline cd ripping without tagging track data">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
  
    <ul class="next_prev">
      
        <li class="prev">
        <a class="btn btn-success" role="button" href="/2017/11/29/How-to-mass-convert-mp3-files-to-aac-m3a/">
          Vorherige Seite
        </a></li>
      
      
        <li class="next">
        <a class="btn btn-success" role="button" href="/2018/01/20/How-to-set-up-raspberry-pi-headless-with-ssh-and-wifi/">
          Nächste Seite
        </a></li>
      
    </ul>
  
  
<div class="row comments">
  <h2>Kommentare</h1>
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</div>


</article>
</div>
    </div>
  </div>
  <div id="push"></div>
  <div class="navbar navbar-footer">
  <div class="container">
    <p class="navbar-center navbar-text">
      
      &copy; 2018 Philipp Keller
      
    </p>
  </div>
</div>
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0-wip/js/bootstrap.min.js"></script>




<script type="text/javascript">
var disqus_shortname = 'randomhowtos';
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



</body>
</html>